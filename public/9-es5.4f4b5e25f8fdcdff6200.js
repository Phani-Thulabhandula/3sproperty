function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{zrcO:function(e,r,t){"use strict";t.r(r),t.d(r,"UsersModule",(function(){return X}));var a,o=t("ofXK"),n=t("TU8p"),i=t("VX/1"),c=t("FKr1"),s=t("tyNb"),u=t("3Pt+"),l=t("FCiN"),b=t.n(l),m=t("fXoL"),f=t("Q7Am"),h=t("tk/3"),d=((a=function(){function e(r){_classCallCheck(this,e),this.http=r,this.user={},this.token="",this.header=new h.d,this.token=localStorage.getItem("_A_tro_ee"),this.header=this.header.set("Authorization","Bearer "+this.token)}return _createClass(e,[{key:"updateProfile",value:function(e){return this.http.post("users/update-profile",e,{headers:this.header})}},{key:"getProfile",value:function(){return this.http.get("users/getprofile",{headers:this.header})}},{key:"uploadPicture",value:function(e){return this.http.post("/posts/upload",e,{headers:this.header})}},{key:"removeImage",value:function(e){return this.http.delete("/posts/delete-image?filename="+e,{headers:this.header})}}]),e}()).\u0275fac=function(e){return new(e||a)(m.ac(h.a))},a.\u0275prov=m.Mb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),p=t("a3ZD"),v=t("XiUz"),g=t("f0Cb"),F=t("kmnG"),y=t("qFsG"),x=t("bTqV"),V=t("NFeN");function W(e,r){if(1&e){var t=m.Xb();m.Wb(0,"div",23),m.Wb(1,"input",24),m.ec("change",(function(e){return m.vc(t),m.ic().handleFileInput(e.target.files)})),m.Vb(),m.Wb(2,"div",25),m.Wb(3,"h3",26),m.Fc(4,"Upload Profile Images"),m.Vb(),m.Rb(5,"mat-icon",27),m.Wb(6,"span",28),m.Fc(7,"Click here or Drag your Image here."),m.Vb(),m.Vb(),m.Vb()}if(2&e){var a=m.ic();m.Db(5),m.oc("icIcon",a.icUpload)}}function I(e,r){if(1&e){var t=m.Xb();m.Wb(0,"div",29),m.Rb(1,"img",30),m.Wb(2,"button",31),m.ec("click",(function(){return m.vc(t),m.ic().deleteImage()})),m.Fc(3," Remove "),m.Vb(),m.Vb()}if(2&e){var a=m.ic();m.Db(1),m.oc("src","https://methille.sirv.com/"+a.userForm.get("avatar").value,m.xc)}}function w(e,r){1&e&&(m.Wb(0,"mat-error"),m.Fc(1," First Name is "),m.Wb(2,"strong"),m.Fc(3,"required"),m.Vb(),m.Vb())}function k(e,r){1&e&&(m.Wb(0,"mat-error"),m.Fc(1," Must be atleat 3 character. "),m.Vb())}function _(e,r){1&e&&(m.Wb(0,"mat-error"),m.Fc(1," Must be atleat 3 character. "),m.Vb())}function C(e,r){1&e&&(m.Wb(0,"mat-error"),m.Fc(1," Invalid Phone Number "),m.Vb())}function D(e,r){1&e&&(m.Wb(0,"mat-error"),m.Fc(1," Email is "),m.Wb(2,"strong"),m.Fc(3,"required"),m.Vb(),m.Vb())}function L(e,r){1&e&&(m.Wb(0,"mat-error"),m.Fc(1," Invalid Email! "),m.Vb())}var S,E,N,P=[{path:"",component:(S=function(){function e(r,t,a,o){_classCallCheck(this,e),this.authService=r,this.userService=t,this.router=a,this.fb=o,this.icUpload=b.a,this.isSubmitted=!1,this.userInfo={id:"",avatar:""}}return _createClass(e,[{key:"ngOnInit",value:function(){this.authService.isLoggedIn$||this.router.navigate([""]),this.userInfo=this.authService.userInfo,this.createUserForm(),this.getUserInfo()}},{key:"ngOnDestroy",value:function(){console.log("afterDestor")}},{key:"createUserForm",value:function(){this.userForm=this.fb.group({email:["",[u.v.required,u.v.email]],first_name:["",[u.v.required,u.v.min(3)]],last_name:["",[u.v.min(3)]],phone:[null,[u.v.min(8)]],avatar:[null]})}},{key:"getUserInfo",value:function(){var e=this;this.userService.getProfile().subscribe((function(r){e.userForm.patchValue(r)}),(function(e){console.log(e)}))}},{key:"updateUser",value:function(){var e=this;this.userForm.valid?this.userService.updateProfile(this.userForm.getRawValue()).subscribe((function(r){localStorage.removeItem("userInfo"),localStorage.setItem("user",JSON.stringify(Object.assign(Object.assign({},e.userForm.getRawValue()),{name:"".concat(e.userForm.value.first_name," ").concat(e.userForm.value.last_name),id:e.userInfo.id}))),e.authService.setUserInfo(Object.assign(Object.assign({},e.userForm.getRawValue()),{name:"".concat(e.userForm.value.first_name," ").concat(e.userForm.value.last_name)})),e.router.navigate([""])})):this.userForm.markAsTouched()}},{key:"deleteImage",value:function(){var e=this;this.userForm.value.avatar&&this.userService.removeImage(this.userForm.value.avatar).subscribe((function(r){e.userForm.patchValue({avatar:""})}))}},{key:"handleFileInput",value:function(e){var r=this;e.forEach((function(e){var t=new FormData;t.append("image",e),r.userService.uploadPicture(t).subscribe((function(e){r.userForm.patchValue({avatar:e.filename})}))}))}}]),e}(),S.\u0275fac=function(e){return new(e||S)(m.Qb(f.a),m.Qb(d),m.Qb(s.f),m.Qb(u.c))},S.\u0275cmp=m.Kb({type:S,selectors:[["vex-users"]],decls:63,vars:9,consts:[["vexContainer","",1,"mt-8"],["fxLayout","row","fxLayoutAlign","start start","fxlayoutGap","10px",1,"w-full",3,"formGroup","ngSubmit"],["fxFlex","22","fxLayout","column",1,"bg-white","m-4","w-full"],[1,"card","p-4","hover:underline","font-semibold","text-primary","cursor-pointer"],[1,"p-4","text-gray"],["fxFlex","78",1,"rounded","m-4","w-full","border-gray-light","border","card"],["fxLayout","row","fxFlexAlign","center center",1,"p-4"],[1,"font-semibold"],[1,"px-gutter","my-2"],["fxFlex","30","fxLayout","column","fxLayoutAlign","center center"],["class","border-2 border-gray w-full hover:border-black border-dashed hover:text-black","style","height: 200px;","fxFlex","85",4,"ngIf"],["class","p-4 w-full","fxLayout","column","fxLayoutAlign","center center",4,"ngIf"],["fxFlex","70","fxLayout","column",1,"p-4","px-8"],["appearance","outline","color","primary",1,"example-full-width"],["matInput","","placeholder","First Name","formControlName","first_name"],[4,"ngIf"],["matInput","","placeholder","Last Name","formControlName","last_name"],["fxLayout","row","fxFlexAlign","start center",1,"px-gutter"],["fxFlex","55","fxLayout","column",1,"p-4","px-8"],["matInput","","placeholder","Enter your phone number","type","number","formControlName","phone"],["matInput","","placeholder","Email","type","email","formControlName","email"],["fxLayout"," row","fxLayoutAlign","end center",1,"p-4"],["mat-raised-button","","color","primary","type","submit"],["fxFlex","85",1,"border-2","border-gray","w-full","hover:border-black","border-dashed","hover:text-black",2,"height","200px"],["type","file","accept","image/*",1,"image_upload","w-full",2,"z-index","99999",3,"change"],["fxLayout","column","fxLayoutAlign","center center",1,"mt-8","text-gray","hover:text-black","cursor-pointer"],[1,"font-bold"],["size","70px",2,"margin-left","-30px",3,"icIcon"],[1,"mt-12"],["fxLayout","column","fxLayoutAlign","center center",1,"p-4","w-full"],[2,"max-width","100%","max-height","100%",3,"src"],["type","button",1,"bg-red","hover:bg-red","text-white","font-bold","py-2","px-4","my-2","rounded","focus:outline-none","focus:shadow-outline",3,"click"]],template:function(e,r){1&e&&(m.Wb(0,"div",0),m.Wb(1,"form",1),m.ec("ngSubmit",(function(){return r.updateUser()})),m.Wb(2,"div",2),m.Wb(3,"div",3),m.Wb(4,"h5"),m.Fc(5,"Edit Profile"),m.Vb(),m.Vb(),m.Rb(6,"mat-divider"),m.Wb(7,"div",4),m.Wb(8,"h5"),m.Fc(9,"Additional Information"),m.Vb(),m.Vb(),m.Vb(),m.Wb(10,"div",5),m.Wb(11,"div",6),m.Wb(12,"h2",7),m.Fc(13," Edit Profile "),m.Vb(),m.Vb(),m.Rb(14,"mat-divider"),m.Wb(15,"div",8),m.Wb(16,"h5",7),m.Fc(17,"Basic Information"),m.Vb(),m.Vb(),m.Wb(18,"div",6),m.Wb(19,"div",9),m.Dc(20,W,8,1,"div",10),m.Dc(21,I,4,1,"div",11),m.Vb(),m.Wb(22,"div",12),m.Wb(23,"mat-form-field",13),m.Wb(24,"mat-label"),m.Fc(25,"First Name"),m.Vb(),m.Rb(26,"input",14),m.Wb(27,"mat-hint"),m.Fc(28,"This will be your display name."),m.Vb(),m.Dc(29,w,4,0,"mat-error",15),m.Dc(30,k,2,0,"mat-error",15),m.Vb(),m.Wb(31,"mat-form-field",13),m.Wb(32,"mat-label"),m.Fc(33,"Last Name(optional)"),m.Vb(),m.Rb(34,"input",16),m.Wb(35,"mat-hint"),m.Fc(36,"Enter your last name!"),m.Vb(),m.Dc(37,_,2,0,"mat-error",15),m.Vb(),m.Vb(),m.Vb(),m.Rb(38,"mat-divider"),m.Wb(39,"div",8),m.Wb(40,"h5",7),m.Fc(41,"Contact Information"),m.Vb(),m.Vb(),m.Wb(42,"div",17),m.Wb(43,"div",18),m.Wb(44,"mat-form-field",13),m.Wb(45,"mat-label"),m.Fc(46,"Phone"),m.Vb(),m.Rb(47,"input",19),m.Wb(48,"mat-hint"),m.Fc(49,"Enter your phone number!"),m.Vb(),m.Dc(50,C,2,0,"mat-error",15),m.Vb(),m.Wb(51,"mat-form-field",13),m.Wb(52,"mat-label"),m.Fc(53,"Email"),m.Vb(),m.Rb(54,"input",20),m.Wb(55,"mat-hint"),m.Fc(56,"Enter your email!"),m.Vb(),m.Dc(57,D,4,0,"mat-error",15),m.Dc(58,L,2,0,"mat-error",15),m.Vb(),m.Vb(),m.Vb(),m.Rb(59,"mat-divider"),m.Wb(60,"div",21),m.Wb(61,"button",22),m.Fc(62," Save Changes "),m.Vb(),m.Vb(),m.Vb(),m.Vb(),m.Vb()),2&e&&(m.Db(1),m.oc("formGroup",r.userForm),m.Db(19),m.oc("ngIf",!r.userForm.get("avatar").value),m.Db(1),m.oc("ngIf",r.userForm.get("avatar").value),m.Db(8),m.oc("ngIf",r.userForm.controls.first_name.hasError("required")),m.Db(1),m.oc("ngIf",r.userForm.controls.first_name.invalid&&!r.userForm.controls.first_name.hasError("required")),m.Db(7),m.oc("ngIf",r.userForm.controls.last_name.invalid&&!r.userForm.controls.last_name.hasError("required")),m.Db(13),m.oc("ngIf",r.userForm.controls.phone.invalid&&!r.userForm.controls.phone.hasError("required")),m.Db(7),m.oc("ngIf",r.userForm.controls.email.hasError("required")),m.Db(1),m.oc("ngIf",r.userForm.controls.email.invalid&&!r.userForm.controls.email.hasError("required")))},directives:[p.a,u.x,u.o,v.d,v.c,u.h,v.b,g.a,v.a,o.n,F.d,F.h,y.a,u.b,u.n,u.f,F.g,u.s,x.b,V.a,i.a,F.c],styles:[".image_upload[_ngcontent-%COMP%]{width:290px;height:200px;cursor:pointer;opacity:0;position:absolute}"]}),S)}],R=((E=function e(){_classCallCheck(this,e)}).\u0275mod=m.Ob({type:E}),E.\u0275inj=m.Nb({factory:function(e){return new(e||E)},imports:[[s.i.forChild(P)],s.i]}),E),U=t("vxfF"),A=t("STbY"),q=t("XVi8"),O=t("YUcS"),j=t("68Yx"),X=((N=function e(){_classCallCheck(this,e)}).\u0275mod=m.Ob({type:N}),N.\u0275inj=m.Nb({factory:function(e){return new(e||N)},imports:[[o.c,R,O.a,n.b,i.b,c.n,x.c,V.b,u.t,U.d,u.i,A.b,q.a,j.a,g.b,y.b,F.f]]}),N)}}]);